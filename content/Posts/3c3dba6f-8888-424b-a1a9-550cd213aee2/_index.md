---
date: 2021-07-19 06:05:00
resources:
- name: c10a970b-bf0d-409b-bf98-3ce8d69e1677.png
  src: c10a970b-bf0d-409b-bf98-3ce8d69e1677.png
  title: ''
- name: 7d4c612d-f29e-44c7-acc4-60556bf7815b.png
  src: 7d4c612d-f29e-44c7-acc4-60556bf7815b.png
  title: ''
title: 파이썬에 대한 몇가지 의문들
weight: 4

---
> ***이 블로그는 Notion에서 랜더링 자동화를 통해 제작되었습니다.<br>Notion 페이지에 최적화되어있습니다. → [Notion에서 보기](https://www.notion.so/hwangseonbi/3c3dba6f8888424ba1a9550cd213aee2)***

<br>



{{< toc >}}

<br>



> ***그 동안 Python을 사용하면서 궁금했던 몇가지 의문들에 대한 답을 채워본다.***

# 1. 파이썬의 실행방식은 C언어 계열과 어떻게 다른가?

파이썬은 스크립트 언어다. 스크립트 언어의 여러 특성 중 하나는 **`인터프리터`** 가 한줄씩 실행시켜 준다는 것이다. (이 때문에 대화형언어라고 한다.) 사용자는 파이썬 코드를 만들고 실행을 시키면 먼저 **`바이트코드`** 가 만들어진다. 이렇게 바이트코드가 만들어지는 과정을 파이썬에서의 컴파일이라 부른다. 그리고나서 `인터프리터`가 바이트코드를 한줄씩 읽고 실행시킨다.

컴파일언어에서의 컴파일을 알고있다면 느꼈을 것이다. 파이썬에서의 컴파일은 C언어의 컴파일과 다르다. 파이썬에서 바이트코드까지 컴파일되었다면 C언어는 `바이너리코드`까지 완전 컴파일된다. 또한 최종적으로 링크라는 과정을 거쳐 해당 플랫폼에서 실행할 수 있는 `실행파일`까지 생성된다. 이 실행파일은 인터프리터 같은 중간다리없이 CPU에서 바로 실행된다.

<br>



```
💡C코드 동작 방식
C언어 코드를 빌드과정을 다시 살펴보자.
- 먼저 `컴파일러`가 C언어를 `어셈블리어`로 변환해 준다.
- `어셈블러`가 어셈블리어를 `바이너리코드`로 바꿔준다. 어셈블리어는 CPU명령어이므로 CPU에 종속적이다.

여기까지가 C언어 코드를 바이너리코드까지 변환하는 과정이고 이를 컴파일이라고한다. 이후에는 `링커`가 시스템 라이브러리 함수 주소와 연결(Dynamic Linking) 또는 라이브러리를 포함(Static Linking)한다. 그러면 우리가 말하는 실행파일이 완성된다.

다음 슬라이드에 잘 나와있다. - [Programming Compile & Loading for Korean](https://prezi.com/obkhqdxaz3zx/programming-compile-loading-for-korean/)
```

<br>



{{< img name="c10a970b-bf0d-409b-bf98-3ce8d69e1677.png" size="large" width="911" lazy=false >}}

<br>



<br>



# 2. 파이썬은 언제, 왜, 어떤 것보다 느린가?

위 1번 항목에서 파이썬의 동작방식은 **`인터프리터란 중간다리를 거쳐 실행된다`** 고 했다. 이것이 C, C++같은 완전컴파일 언어와의 차이점이다. 파이썬에서는 보통 빌드나 make같은 단계가 없다. 또한 파이썬의 바이트코드는 이진기계코드(intel or arm 칩 명령어)가 아니라 단순히 파이썬 고유 표현방식일 뿐이다.

‌

이것이 파이썬이 C, C++만큼 빠르지 않은 이유이다. 인터프리터(더 상세히는 PVM 루프. 6번 질문에서 조금 더 상세히 설명한다.)는 CPU 칩이 아니므로 여전히 바이트 코드를 머신코드로 해석해야하며, 바이트 코드 명령어들은 CPU 명령어보다 더 많은 작업을 해야한다. 다만 파이썬은 내부 컴파일 단계가 존재하므로 코드를 실행할 때마다 전통적인 인터프리터 언어와 같이 재분석, 재해석이 필요없어 전통적인 인터프리터 언어들보다는 빠르다.

<br>



<br>



# 3. 파이썬을 선택하는 이유는 무엇인가?

그럼에도 파이썬을 사용하는 이유는 현대 컴퓨터 속도는 프로그램을 실행시키기에 충분히 빠르며 실행속도가 최적화되야하는 분야는 정해져있기 때문이다.

다시말해 반드시 빨라야하는 분야가 아니라면 실행속도를 포기하고 파이썬으로 개발하였을 때 향상되는 **`개발 속도 면에서의 이득`** 이 더 크기 때문이다.

‌

또한 어느 정도의 속도 개선은 파이썬을 통해서도 해결 가능한 방법이 있다. 예를 들면 수치 연산 프로그래밍이라던가 애니메이션에서 핵심이 되는 방대한 수를 계산하는 컴포넌트에서 연산 속도가 나와야한다고 하자. 최적의 속도를 필요로하는 애플리케이션의 일부를 **`컴파일 확장으로 분리`** 하고, 이 확장을 파이썬 스크립트에서 사용하기 위해 그대의 시스템에 링크한다.

‌

이처럼 파이썬이 제어 언어로서의 역할을 하는 경우가 있다. NumPy 수치 연산 확장이 그 예이다. NumPy는 컴파일된 최적화된 수치 연산 확장 라이브러리를 파이썬 언어와 결합함으로써 효율적이고 사용하기 쉬운 수치 연산 프로그래밍 도구가 된다.

‌

**`파이썬은 다른 언어와 함께 사용할 수 있다.`** 

‌

파이썬 프로그램은 다른 언어로 작성된 컴포넌트에 다양한 방법으로 쉽게 연결될 수 있다.

‌

예를 들어, 파이썬의 C API를 이용하면 C 프로그램에서 파이썬을 호출하거나 파이썬 프로그램에서 C 프로그램을 호출할 수 있다. 즉 필요하다면 C언어로 작성된 기능을 파이썬 시스템에 추가할 수 있고, 다른 환경이나 시스템에서 파이썬 프로그램을 이용할 수 있음을 의미한다.

‌

신속한 개발 속도를 위해 시스템을 먼저 파이썬으로 구현한 다음, 제품에 대한 성능 요구사항이 발생할 때 하나씩 C 코드로 옮겨 구현하는 개발 방법도 가능하다.

<br>



<br>



# 4. '파이썬 내부는 C로 돈다' ?

먼저 "파이썬 내부"가 무엇인지 정확히 정의하자. 파이썬은 프로그래밍 언어를 의미할 수도 있고 인터프리터라고 불리는 소프트웨어 패키지를 의미할 수도 있다. 사용자가 파이썬 코드를 작성하면 인터프리터는 코드를 읽고 코드에 해당하는 명령을 수행한다.

`이때 인터프리터가 C로 구현되거나 자바로 구현되는 등 다양한 방법으로 만들어질 수 있다.`

우리가 표준으로 사용하고 있는 파이썬 인터프리터가 C로 만들어진 CPython을 사용하기 때문에 파이썬 내부가 C로 돌아간다고 말할 수 있는 지점이다.

<br>



<br>



# 5. CPython, Jython ?

인터프리터의 종류이다. 위 4번 내용을 읽었다면 눈치챘겠지만 Jython이란 Java로 만들어진 인터프리터이다. 6. 파이썬 내부동작에서 더 자세하게 다룬다.

<br>



<br>



# 6. 파이썬 내부 동작

사용자가 스크립트를 작성하면 인터프리터는 그 코드를 읽고 실행시킨다. 이때 인터프리터는 내부적으로 많은 일을 한다. 사용자가 스크립트 파일을 파이썬에게 실행하도록 명령했을 때, 다음 단계가 수행된다.

‌

1. 바이트코드(.pyc)라고 불리는 상태로 스크립트 파일을 컴파일한다.

- 바이트코드는 소스코드에 대한 저수준, 플랫폼 독립적인 표현이며 컴파일을 통해 소스코드의 statement는 개별적인 단계로 분해되서 바이트 코드로 그룹화된다. 이때 파이썬 프로그램의 종류(인터프리터의 종류)에 따라 바이트코드는 다를 수 있다.

- 그러니까 이 바이트코드만 있으면 어느 플랫폼에 가서도 실행 가능하다. 물론 해당 플랫폼에 파이썬 인터프리터가 설치되어있긴 해야한다. 컴파일된 인터프리터 종류도 같아야한다. Cython으로 컴파일한 파이트코드는 Jython으로 실행할 수 없다.

{{< img name="7d4c612d-f29e-44c7-acc4-60556bf7815b.png" size="large" width="1891" lazy=false >}}

<br>



2. 바이트코드는 파이썬 가상머신(PVM)이라고 불리는 곳에 전달된다.

- **`PVM`** 이란 Python Virutal machine이란 뜻이며 **`바이트코드 명령을 차례로 반복`** 시키는 단순히 큰 루프이며 **`파이썬의 런티임 엔진`** 이다. 이 단계가 사실상 마지막 인터프리터 단계이다.‌

<br>



그런데 이러한 점들은 사용자에게 공개되지 않는다. 그럼으로써 사용자는 그저 파이썬 코드를 짜는데 집중할 수 있다. 사용자는 코드를 짜고 실행시키기만하면 된다.

‌

이런 일련의 과정들을 통틀어서 **`실행모델`** 이라고 한다. 인터프리터가 일하는 방식정도로 생각하면 된다. 실행모델은 위와같은 방식이 표준이지만 **`사용 용도에 따라 변형될 수 있다.`**  이러한 변형된 실행 모델들의 예가 CPython, Jython, IronPython, Stackless, PyPy 등 이다. 이들은 같은 파이썬 언어를 구현하지만 각기 다른 방식으로 프로그램을 실행한다. 즉 하나의 파이썬 소스를 각기 다른 방법으로 실행시킨다. Cython, Shed Skin 등의 모델도 있지만 이것들은 표준 파이썬 언어를 구현하지 않기 때문에 최적화 도구로서 볼수도 있다.  우리가 흔히 쓰는 파이썬 실행모델이며 표준인 모델은 CPython이다. CPython부터 시작해 몇가지 주요 실행모델을 정리해보았다.

‌

- CPython : 일반적으로 말하는 Python이다(표준). 이식성을 고려해 ANSI C언어로 구현되었다는 사실에서 CPython이란 이름이 붙었다.

- Jython : 자바를 위한 파이썬이다. 자바 프로그래밍 언어와의 통합을 목적으로 한 파이썬 언어의 다른 구현이다. Jython은 파이썬 소스 코드를 자바 바이트 코드로 컴파일하고 생성된 바이트코드를 JVM으로 전달하는 자바 클래스로 구성되어있다. 개발자는 여전히 .py파일로 소스를 저장하고 Jython 시스템으로 실행시키면된다. 즉 파이썬 코드로 자바 애플리케이션 작성을 가능하게 한다. 런타임 시에는 실제 자바 애플리케이션처럼 보인다. CPython보다는 느리고 안정성이 떨어진다.

- IronPython : .NET을 위한 파이썬. Jython과 매우 유사하다.

- Stackless : 동시성을 위한 파이썬. Concurrency를 지향하는 표준 CPython언어의 재구현이며 향상된 버전이다. C언어의 call stack에 상태를 저장하지 않기 때문에 파이썬을 스택이 작은 아키텍처에 쉽게 이식할 수 있도록 하고, 효율적인 멀티프로세스 옵션을 제공하며 corrutine을 구현할 수 있다. 특히 microthread는 파이썬의 표준 멀티태스킹 도구인 스레드와 프로세스보다 효율적이고 가볍다.

- PyPy: 속도를 위한 파이썬이다. 성능에 초점이 맞추어져 있다.

<br>



<br>



# 7. Reference

Learning Python - Mark Lutz 저

[https://cjh5414.github.io/about-python-and-how-python-works/](https://cjh5414.github.io/about-python-and-how-python-works/)

[https://github.com/Jpub/LearningPython](https://github.com/Jpub/LearningPython)

<br>



<br>

